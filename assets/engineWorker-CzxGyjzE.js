function h(e,t){let n,s;try{const i=p(e,o.__wbindgen_malloc,o.__wbindgen_realloc),a=g,r=o.wasm_eval(i,a,t);return n=r[0],s=r[1],b(r[0],r[1])}finally{o.__wbindgen_free(n,s,1)}}function A(e){let t,n;try{const s=p(e,o.__wbindgen_malloc,o.__wbindgen_realloc),i=g,a=o.wasm_get_moves(s,i);return t=a[0],n=a[1],b(a[0],a[1])}finally{o.__wbindgen_free(t,n,1)}}function M(){return{__proto__:null,"./klikschaak_engine_bg.js":{__proto__:null,__wbindgen_init_externref_table:function(){const t=o.__wbindgen_externrefs,n=t.grow(4);t.set(0,void 0),t.set(n+0,void 0),t.set(n+1,null),t.set(n+2,!0),t.set(n+3,!1)}}}}function b(e,t){return e=e>>>0,T(e,t)}let l=null;function d(){return(l===null||l.byteLength===0)&&(l=new Uint8Array(o.memory.buffer)),l}function p(e,t,n){if(n===void 0){const c=u.encode(e),f=t(c.length,1)>>>0;return d().subarray(f,f+c.length).set(c),g=c.length,f}let s=e.length,i=t(s,1)>>>0;const a=d();let r=0;for(;r<s;r++){const c=e.charCodeAt(r);if(c>127)break;a[i+r]=c}if(r!==s){r!==0&&(e=e.slice(r)),i=n(i,s,s=r+e.length*3,1)>>>0;const c=d().subarray(i+r,i+s),f=u.encodeInto(e,c);r+=f.written,i=n(i,s,r,1)>>>0}return g=r,i}let _=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});_.decode();const R=2146435072;let w=0;function T(e,t){return w+=t,w>=R&&(_=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),_.decode(),w=t),_.decode(d().subarray(e,e+t))}const u=new TextEncoder;"encodeInto"in u||(u.encodeInto=function(e,t){const n=u.encode(e);return t.set(n),{read:e.length,written:n.length}});let g=0,o;function v(e,t){return o=e.exports,l=null,o.__wbindgen_start(),o}async function x(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(i){if(e.ok&&n(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const s=await e.arrayBuffer();return await WebAssembly.instantiate(s,t)}else{const s=await WebAssembly.instantiate(e,t);return s instanceof WebAssembly.Instance?{instance:s,module:e}:s}function n(s){switch(s){case"basic":case"cors":case"default":return!0}return!1}}async function S(e){if(o!==void 0)return o;e!==void 0&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),e===void 0&&(e=new URL(""+new URL("klikschaak_engine_bg-DrTdmqJG.wasm",import.meta.url).href,import.meta.url));const t=M();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:s}=await x(await e,t);return v(n)}let y=!1;async function m(){y||(await S(),y=!0)}self.onmessage=async e=>{const{id:t,type:n,fen:s,depth:i}=e.data;try{await m();let a;if(n==="eval")a=h(s,i??4);else if(n==="moves")a=A(s);else{self.postMessage({id:t,error:`Unknown message type: ${n}`});return}self.postMessage({id:t,result:JSON.parse(a)})}catch(a){self.postMessage({id:t,error:String(a)})}};m().then(()=>{self.postMessage({type:"ready"})}).catch(e=>{self.postMessage({type:"error",error:String(e)})});
